# 시럽조제기 연결 관리자

시럽조제기와의 연결을 관리하고 처방전 데이터를 자동으로 전송하는 Electron 기반 데스크톱 애플리케이션입니다.

## 주요 기능

- **자동 연결 관리**: 저장된 시럽조제기들을 자동으로 연결하고 상태를 모니터링
- **처방전 파일 처리**: CSV 형식의 처방전 파일을 자동으로 파싱하고 전송
- **자동 조제**: 새로운 처방전이 감지되면 자동으로 조제 시작
- **수동 조제**: 개별 약물을 수동으로 조제할 수 있는 기능
- **네트워크 스캔**: 로컬 네트워크에서 시럽조제기를 자동으로 발견
- **연결 상태 모니터링**: 실시간으로 연결 상태를 확인하고 자동 재연결
- **🆕 자동 업데이트**: GitHub 릴리즈를 통한 자동 업데이트 지원

## 설치 방법

### 방법 1: NSIS 설치 프로그램 (권장)

1. `build-installer.bat` 파일을 실행하여 설치 프로그램 생성
2. 생성된 `release\시럽조제기 연결 관리자 Setup 1.0.0.exe`를 **관리자 권한으로 실행**
3. 설치 마법사를 따라 설치 완료
4. 바탕화면과 시작 메뉴에서 프로그램을 실행할 수 있습니다

### 방법 2: 자동 설치

1. `install.bat` 파일을 **관리자 권한으로 실행**
2. 설치가 완료되면 바탕화면과 시작 메뉴에서 프로그램을 실행할 수 있습니다

### 방법 3: 수동 설치

1. `release/win-unpacked` 폴더의 내용을 원하는 위치에 복사
2. `시럽조제기 연결 관리자.exe`를 실행

## 제거 방법

`uninstall.bat` 파일을 **관리자 권한으로 실행**하면 프로그램이 완전히 제거됩니다.

## 사용 방법

### 1. 초기 설정

1. **처방전 파일 경로 설정**: 처방전 CSV 파일이 저장된 폴더를 선택
2. **네트워크 스캔**: "Q 네트워크 스캔 시작" 버튼을 클릭하여 시럽조제기 발견
3. **시럽조제기 등록**: 발견된 기기를 선택하고 약품명, 약품코드를 입력 후 "저장"

### 2. 자동 조제 설정

- "자동 조제 활성화" 체크박스를 선택하면 새로운 처방전이 감지될 때 자동으로 조제가 시작됩니다

### 3. 수동 조제

- "수동조제" 탭에서 개별 약물을 선택하여 수동으로 조제할 수 있습니다

### 4. 연결 관리

- 저장된 시럽조제기 목록에서 기기를 선택하여 연결/연결 해제/삭제 가능
- 연결된 기기의 상태가 실시간으로 표시됩니다

### 5. 자동 업데이트

- 앱 시작 시 자동으로 업데이트 확인
- 새 버전이 있으면 알림 표시
- 사용자가 업데이트 다운로드 및 설치 선택 가능
- 우측 상단 새로고침 버튼(⟳)으로 수동 업데이트 확인 가능

> 📖 **자세한 업데이트 가이드**: [GITHUB_UPDATE_GUIDE.md](GITHUB_UPDATE_GUIDE.md) 참고

## 파일 구조

```
prescription/
├── main.js                 # Electron 메인 프로세스
├── renderer.js             # 렌더러 프로세스 (UI 로직)
├── index.html              # 메인 UI
├── styles.css              # 스타일시트
├── package.json            # 프로젝트 설정
├── install.bat             # 설치 스크립트
├── uninstall.bat           # 제거 스크립트
└── release/
    └── win-unpacked/       # 실행 파일
        └── 시럽조제기 연결 관리자.exe
```

## 데이터 파일

프로그램 실행 시 다음 파일들이 자동으로 생성됩니다:

- `connections.json`: 저장된 시럽조제기 연결 정보
- `prescription_path.txt`: 처방전 파일 경로
- `auto_dispensing_settings.json`: 자동 조제 설정
- `transmission_status.json`: 전송 상태 정보
- `medicine_transmission_status.json`: 약물별 전송 상태

## 시스템 요구사항

- Windows 10 이상
- 관리자 권한 (설치 시)
- 네트워크 연결

## 문제 해결

### 연결이 안 되는 경우
1. 시럽조제기가 네트워크에 연결되어 있는지 확인
2. 방화벽 설정 확인
3. 네트워크 스캔을 다시 실행

### 자동 조제가 작동하지 않는 경우
1. "자동 조제 활성화"가 체크되어 있는지 확인
2. 처방전 파일 경로가 올바른지 확인
3. 시럽조제기가 연결되어 있는지 확인

## 개발자 정보

이 프로그램은 Electron과 Node.js를 기반으로 개발되었습니다.

### 개발 환경 설정

```bash
npm install
npm start
```

### 빌드

#### NSIS 설치 프로그램 빌드 (권장)
```bash
# 자동 빌드 스크립트 실행
build-installer.bat

# 또는 수동으로 단계별 실행
npm run build
npm run build-nsis
```

#### Electron Builder 사용
```bash
npm run build-installer
```

#### 모든 빌드 옵션
```bash
npm run build-all
```

#### GitHub 릴리즈에 자동 배포
```bash
# 환경 변수 설정
set GH_TOKEN=your_github_token

# 빌드 및 GitHub에 릴리즈
npm run build

# 또는
npx electron-builder --win --x64 --publish always
```

> **참고**: GitHub 자동 배포 설정은 [GITHUB_UPDATE_GUIDE.md](GITHUB_UPDATE_GUIDE.md)를 참고하세요.

## 라이선스

MIT License 